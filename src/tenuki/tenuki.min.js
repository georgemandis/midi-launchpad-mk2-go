/*!
 * tenuki v0.2.2 (https://github.com/aprescott/tenuki.js)
 * Copyright Â© 2016 Adam Prescott.
 * Licensed under the MIT license.
 */
(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.tenuki=t()}})(function(){var t,e,r;return function t(e,r,n){function i(s,o){if(!r[s]){if(!e[s]){var u=typeof require=="function"&&require;if(!o&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){var r=e[s][1][t];return i(r?r:t)},f,f.exports,t,e,r,n)}return r[s].exports}var a=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){"use strict";r.Game=t("./lib/game").default;r.Client=t("./lib/client").default;r.utils=t("./lib/utils").default},{"./lib/client":3,"./lib/game":6,"./lib/utils":14}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=f(i);var s=t("./intersection");var o=f(s);var u=t("./zobrist");var l=f(u);function f(t){return t&&t.__esModule?t:{default:t}}var c=function t(e){var r=e.moveNumber,n=e.playedPoint,i=e.color,a=e.pass,s=e.blackPassStones,o=e.whitePassStones,u=e.intersections,f=e.blackStonesCaptured,c=e.whiteStonesCaptured,d=e.capturedPositions,h=e.koPoint,v=e.boardSize;this.moveNumber=r;this.playedPoint=n;this.color=i;this.pass=a;this.blackPassStones=s;this.whitePassStones=o;this.intersections=u;this.blackStonesCaptured=f;this.whiteStonesCaptured=c;this.capturedPositions=d;this.koPoint=h;this.boardSize=v;this._positionHash=l.default.hash(v,u);Object.freeze(this)};c.prototype={_capturesFrom:function t(e,r,n){var i=this;var s=this.neighborsFor(e,r).filter(function(t){return!t.isEmpty()&&t.value!==n&&i.libertiesAt(t.y,t.x)===1});var o=a.default.flatMap(s,function(t){return i.groupAt(t.y,t.x)});return a.default.unique(o)},_updateIntersection:function t(e,r,n){return r.map(function(t){if(t.y===e.y&&t.x===e.x){return new o.default(t.y,t.x,n)}else{return t}})},_removeIntersection:function t(e,r){return this._updateIntersection(e,r,"empty")},_withoutIntersectionsMatching:function t(e){var r=this.intersections.map(function(t){if(e(t)){return new o.default(t.y,t.x,"empty")}else{return t}});return this._withNewPoints(r)},_withNewPoints:function t(e){var r=new c({moveNumber:this.moveNumber,playedPoint:this.playedPoint,color:this.color,pass:this.pass,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:e,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:this.capturedPositions,koPoint:this.koPoint,boardSize:this.boardSize});return r},yCoordinateFor:function t(e){return this.boardSize-e},xCoordinateFor:function t(e){var r=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];return r[e]},playPass:function t(e){var r={moveNumber:this.moveNumber+1,playedPoint:null,color:e,pass:true,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:this.intersections,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:[],koPoint:null,boardSize:this.boardSize};r[e+"PassStones"]+=1;var n=new c(r);return n},playAt:function t(e,r,n){var i=this;var a=this._capturesFrom(e,r,n);var s=this.intersectionAt(e,r);var o=this.intersections;a.forEach(function(t){o=i._removeIntersection(t,o)});o=this._updateIntersection(s,o,n);var u=this.blackStonesCaptured+(n==="black"?0:a.length);var l=this.whiteStonesCaptured+(n==="white"?0:a.length);var f=this.boardSize;var d={moveNumber:this.moveNumber+1,playedPoint:s,color:n,pass:false,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:o,blackStonesCaptured:u,whiteStonesCaptured:l,capturedPositions:a,boardSize:f};var h=new c(d);var v=a.length===1&&h.groupAt(e,r).length===1&&h.inAtari(e,r);if(v){d["koPoint"]={y:a[0].y,x:a[0].x}}else{d["koPoint"]=null}return new c(d)},intersectionAt:function t(e,r){return this.intersections[e*this.boardSize+r]},groupAt:function t(e,r){var i=this.intersectionAt(e,r);var a=this.partitionTraverse(i,function(t){return t.sameColorAs(i)}),s=n(a,2),o=s[0],u=s[1];return o},libertiesAt:function t(e,r){var n=this;var i=this.intersectionAt(e,r);var s=a.default.flatMap(this.groupAt(i.y,i.x),function(t){return n.neighborsFor(t.y,t.x).filter(function(t){return t.isEmpty()})});return a.default.unique(s).length},inAtari:function t(e,r){return this.libertiesAt(e,r)===1},neighborsFor:function t(e,r){var n=[];if(r>0){n.push(this.intersectionAt(e,r-1))}if(r<this.boardSize-1){n.push(this.intersectionAt(e,r+1))}if(e>0){n.push(this.intersectionAt(e-1,r))}if(e<this.boardSize-1){n.push(this.intersectionAt(e+1,r))}return n},positionSameAs:function t(e){return this._positionHash===e._positionHash&&this.intersections.every(function(t){return t.sameColorAs(e.intersectionAt(t.y,t.x))})},partitionTraverse:function t(e,r){var n=[];var i=[];var s=[];s.push(e);while(s.length>0){var o=s.pop();if(n.indexOf(o)>-1){}else{n.push(o);this.neighborsFor(o.y,o.x).forEach(function(t){if(n.indexOf(t)>-1){}else{if(r(t)){s.push(t)}else{i.push(t)}}})}}return[n,a.default.unique(i)]}};c._initialFor=function(t,e){this._cache=this._cache||{};this._cache[t]=this._cache[t]||{};if(this._cache[t][e]){return this._cache[t][e]}var r=Array.apply(null,Array(t*t));r=r.map(function(e,r){return new o.default(Math.floor(r/t),r%t)});var n=t>11?3:2;var i={topRight:{y:n,x:t-n-1},bottomLeft:{y:t-n-1,x:n},bottomRight:{y:t-n-1,x:t-n-1},topLeft:{y:n,x:n},middle:{y:(t+1)/2-1,x:(t+1)/2-1},middleLeft:{y:(t+1)/2-1,x:n},middleRight:{y:(t+1)/2-1,x:t-n-1},middleTop:{y:n,x:(t+1)/2-1},middleBottom:{y:t-n-1,x:(t+1)/2-1}};var a={0:[],1:[],2:[i.topRight,i.bottomLeft],3:[i.topRight,i.bottomLeft,i.bottomRight],4:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft],5:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middle],6:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight],7:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middle],8:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom],9:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom,i.middle]};a[e].forEach(function(e){r[e.y*t+e.x]=new o.default(e.y,e.x,"black")});var s=new c({color:e>1?"black":"white",moveNumber:0,intersections:Object.freeze(r),blackStonesCaptured:0,whiteStonesCaptured:0,whitePassStones:0,blackPassStones:0,boardSize:t});this._cache[t][e]=s;return s};r.default=c},{"./intersection":7,"./utils":14,"./zobrist":15}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./game");var i=a(n);function a(t){return t&&t.__esModule?t:{default:t}}var s=function t(e){this._boardElement=e};s.prototype={setup:function t(e){var r=this;var n=e.player,a=e.gameOptions,s=e.hooks;this._player=n;this._hooks=s;if(this._player!=="black"&&this._player!=="white"){throw new Error("Player must be either black or white, but was given: "+this._player)}a["_hooks"]={handleClick:function t(e,n){if(r._busy){return}r._busy=true;if(r.isOver()){var i=r._game.currentState().groupAt(e,n).map(function(t){return{y:t.y,x:t.x,color:t.color}});r._hooks.submitMarkDeadAt(e,n,i,function(t){if(t){r._game.toggleDeadAt(e,n)}r._busy=false})}else{if(r._player!==r.currentPlayer()){r._busy=false;return}r._hooks.submitPlay(e,n,function(t){if(t){r._game.playAt(e,n,r._player)}r._busy=false})}},hoverValue:function t(e,n){if(!r._busy&&r._player===r.currentPlayer()&&!r.isOver()&&!r._game.isIllegalAt(e,n)){return r._player}},gameIsOver:function t(){return r.isOver()}};this._game=new i.default(this._boardElement);this._game.setup(a)},isOver:function t(){return this._game.isOver()},currentPlayer:function t(){return this._game.currentPlayer()},receivePlay:function t(e,r){if(this._player===this.currentPlayer()){return}this._game.playAt(e,r)},moveNumber:function t(){return this._game.moveNumber()},receivePass:function t(){if(this._player===this.currentPlayer()){return}this._game.pass()},receiveMarkDeadAt:function t(e,r){this._game.toggleDeadAt(e,r)},deadStones:function t(){return this._game.deadStones()},setDeadStones:function t(e){this._game._deadPoints=e.map(function(t){return{y:t.y,x:t.x}});this._game.render()},pass:function t(){var e=this;if(this._busy||this._player!==this.currentPlayer()){return}this._busy=true;this._hooks.submitPass(function(t){if(t){e._game.pass()}e._busy=false})}};r.default=s},{"./game":6}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=o(n);var a=t("./renderer");var s=o(a);function o(t){return t&&t.__esModule?t:{default:t}}var u=function t(e,r){var n=r.hooks,a=r.options;s.default.call(this,e,{hooks:n,options:a});if(this.smallerStones){i.default.addClass(e,"tenuki-smaller-stones")}i.default.addClass(e,"tenuki-dom-renderer")};u.prototype=Object.create(s.default.prototype);u.prototype.constructor=u;u.prototype._setup=function(t){s.default.prototype._setup.call(this,t);this.BOARD_LENGTH+=1;this.computeSizing()};u.prototype.generateBoard=function(t){var e=this;var r=this.boardElement;var n=e.zoomContainer;i.default.appendElement(n,i.default.createElement("div",{class:"lines horizontal"}));i.default.appendElement(n,i.default.createElement("div",{class:"lines vertical"}));i.default.appendElement(n,i.default.createElement("div",{class:"hoshi-points"}));i.default.appendElement(n,i.default.createElement("div",{class:"intersections"}));s.default.hoshiPositionsFor(t.boardSize).forEach(function(t){var n=i.default.createElement("div",{class:"hoshi"});n.style.left=t.left*(e.INTERSECTION_GAP_SIZE+1)+"px";n.style.top=t.top*(e.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".hoshi-points"),n)});for(var a=0;a<t.boardSize;a++){var o=i.default.createElement("div",{class:"line horizontal"});o.setAttribute("data-left-gutter",t.yCoordinateFor(a));i.default.appendElement(r.querySelector(".lines.horizontal"),o);var u=i.default.createElement("div",{class:"line vertical"});u.setAttribute("data-top-gutter",t.xCoordinateFor(a));i.default.appendElement(r.querySelector(".lines.vertical"),u);for(var l=0;l<t.boardSize;l++){var f=i.default.createElement("div",{class:"intersection empty"});var c=i.default.createElement("div",{class:"stone"});i.default.appendElement(f,c);f.setAttribute("data-position-x",l);f.setAttribute("data-position-y",a);f.style.left=l*(e.INTERSECTION_GAP_SIZE+1)+"px";f.style.top=a*(e.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".intersections"),f);e.grid[a]=e.grid[a]||[];e.grid[a][l]=f;this.addIntersectionEventListeners(f,a,l)}}i.default.addEventListener(r.querySelector(".lines.horizontal"),"mousedown",function(t){t.preventDefault()});i.default.addEventListener(r.querySelector(".lines.vertical"),"mousedown",function(t){t.preventDefault()});r.querySelector(".lines.horizontal").style.width=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.horizontal").style.height=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.width=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.height=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px"};u.prototype.setIntersectionClasses=function(t,e,r){if(t.className!==r.join(" ")){t.className=r.join(" ")}};r.default=u},{"./renderer":10,"./utils":14}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function t(e,r){this.boardState=e;this.intersection=r;Object.freeze(this)};n.prototype={diagonals:function t(){var e=this;var t=[];var r=[];var n=[];if(this.intersection.x>0){r.push(this.intersection.x-1)}if(this.intersection.x<this.boardState.boardSize-1){r.push(this.intersection.x+1)}if(this.intersection.y>0){n.push(this.intersection.y-1)}if(this.intersection.y<this.boardState.boardSize-1){n.push(this.intersection.y+1)}r.forEach(function(r){n.forEach(function(n){t.push(e.boardState.intersectionAt(n,r))})});return t},isFalse:function t(){if(!this.intersection.isEmpty()){return false}var e=this.diagonals();var r=e.length<=2;var n=this.neighbors();var i=n.filter(function(t){return!t.isEmpty()});if(r&&i.length<1){return false}if(!r&&i.length<2){return false}var a=e.filter(function(t){return!t.isEmpty()&&!t.sameColorAs(i[0])});if(r){return a.length>=1}else{return a.length>=2}},neighbors:function t(){return this.boardState.neighborsFor(this.intersection.y,this.intersection.x)},filledColor:function t(){if(!this.isFalse()){throw new Error("Attempting to find filled color for a non-false eye")}return this.neighbors()[0].value}};r.default=n},{}],6:[function(t,e,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(r,"__esModule",{value:true});var i=typeof Symbol==="function"&&n(Symbol.iterator)==="symbol"?function(t){return typeof t==="undefined"?"undefined":n(t)}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t==="undefined"?"undefined":n(t)};var a=t("./dom-renderer");var s=y(a);var o=t("./svg-renderer");var u=y(o);var l=t("./null-renderer");var f=y(l);var c=t("./board-state");var d=y(c);var h=t("./ruleset");var v=y(h);var p=t("./scorer");var m=y(p);function y(t){return t&&t.__esModule?t:{default:t}}var E=["boardSize","scoring","handicapStones","koRule","komi","_hooks","fuzzyStonePlacement","renderer","freeHandicapPlacement"];var b=function t(e){this._defaultBoardSize=19;this.boardSize=null;this._moves=[];this.callbacks={postRender:function t(){}};this._boardElement=e;this._defaultScoring="territory";this._defaultKoRule="simple";this._defaultRenderer="svg";this._deadPoints=[]};b.prototype={_configureOptions:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.boardSize,n=r===undefined?this._defaultBoardSize:r,a=e.komi,o=a===undefined?0:a,l=e.handicapStones,f=l===undefined?0:l,c=e.freeHandicapPlacement,h=c===undefined?false:c,p=e.scoring,y=p===undefined?this._defaultScoring:p,E=e.koRule,b=E===undefined?this._defaultKoRule:E,S=e.renderer,g=S===undefined?this._defaultRenderer:S;if(typeof n!=="number"){throw new Error("Board size must be a number, but was: "+(typeof n==="undefined"?"undefined":i(n)))}if(typeof f!=="number"){throw new Error("Handicap stones must be a number, but was: "+(typeof n==="undefined"?"undefined":i(n)))}if(f>0&&n!==9&&n!==13&&n!==19){throw new Error("Handicap stones not supported on sizes other than 9x9, 13x13 and 19x19")}if(f<0||f===1||f>9){throw new Error("Only 2 to 9 handicap stones are supported")}if(n>19){throw new Error("cannot generate a board size greater than 19")}this.boardSize=n;this.handicapStones=f;this._freeHandicapPlacement=h;this._scorer=new m.default({scoreBy:y,komi:o});this._rendererChoice={dom:s.default,svg:u.default}[g];if(!this._rendererChoice){throw new Error("Unknown renderer: "+g)}this._whiteMustPassLast=this._scorer.usingPassStones();this._ruleset=new v.default({koRule:b});if(this._freeHandicapPlacement){this._initialState=d.default._initialFor(n,0)}else{this._initialState=d.default._initialFor(n,f)}},_stillPlayingHandicapStones:function t(){return this._freeHandicapPlacement&&this.handicapStones>0&&this._moves.length<this.handicapStones},setup:function t(){var e=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};for(var n in r){if(r.hasOwnProperty(n)&&E.indexOf(n)<0){throw new Error("Unrecognized game option: "+n)}}this._configureOptions(r);if(this._boardElement){var i={handleClick:function t(r,n){if(e.isOver()){e.toggleDeadAt(r,n)}else{e.playAt(r,n)}},hoverValue:function t(r,n){if(!e.isOver()&&!e.isIllegalAt(r,n)){return e.currentPlayer()}},gameIsOver:function t(){return e.isOver()}};this.renderer=new this._rendererChoice(this._boardElement,{hooks:r["_hooks"]||i,options:{fuzzyStonePlacement:r["fuzzyStonePlacement"]}})}else{this.renderer=new f.default}this.render()},intersectionAt:function t(e,r){return this.currentState().intersectionAt(e,r)},intersections:function t(){return this.currentState().intersections},deadStones:function t(){return this._deadPoints},coordinatesFor:function t(e,r){return this.currentState().xCoordinateFor(r)+this.currentState().yCoordinateFor(e)},currentPlayer:function t(){if(this._stillPlayingHandicapStones()){return"black"}var e=this.currentState().color;if(e==="black"){return"white"}else{return"black"}},isWhitePlaying:function t(){return this.currentPlayer()==="white"},isBlackPlaying:function t(){return this.currentPlayer()==="black"},score:function t(){return this._scorer.score(this)},currentState:function t(){return this._moves[this._moves.length-1]||this._initialState},moveNumber:function t(){return this.currentState().moveNumber},playAt:function t(e,r){if(this.isIllegalAt(e,r)){return false}var n=this.currentState().playAt(e,r,this.currentPlayer());this._moves.push(n);this.render();return true},pass:function t(){if(this.isOver()){return false}var e=this.currentState().playPass(this.currentPlayer());this._moves.push(e);this.render();return true},isOver:function t(){if(this._moves.length<2){return false}if(this._whiteMustPassLast){var e=this._moves[this._moves.length-1];var r=this._moves[this._moves.length-2];return e.pass&&r.pass&&e.color==="white"}else{var n=this._moves[this._moves.length-1];var i=this._moves[this._moves.length-2];return n.pass&&i.pass}},toggleDeadAt:function t(e,r){var n=this;if(this.intersectionAt(e,r).isEmpty()){return}var i=this._isDeadAt(e,r);this.currentState().groupAt(e,r).forEach(function(t){if(i){n._deadPoints=n._deadPoints.filter(function(e){return!(e.y===t.y&&e.x===t.x)})}else{n._deadPoints.push({y:t.y,x:t.x})}});this.render();return true},_isDeadAt:function t(e,r){return this._deadPoints.some(function(t){return t.y===e&&t.x===r})},isIllegalAt:function t(e,r){return this._ruleset.isIllegal(e,r,this)},territory:function t(){if(!this.isOver()){return{black:[],white:[]}}return this._scorer.territory(this)},undo:function t(){this._moves.pop();this.render()},render:function t(){if(!this.isOver()){this._deadPoints=[]}this.renderer.render(this.currentState(),{territory:this.territory(),deadStones:this.deadStones()});this.callbacks.postRender(this)}};r.default=b},{"./board-state":2,"./dom-renderer":4,"./null-renderer":8,"./ruleset":11,"./scorer":12,"./svg-renderer":13}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function t(e,r,n){this.y=e;this.x=r;this.value=n||"empty";Object.freeze(this)};n.prototype={isOccupiedWith:function t(e){if(this.isEmpty()){return false}return this.value===e},isBlack:function t(){return this.value==="black"},isWhite:function t(){return this.value==="white"},isEmpty:function t(){return this.value==="empty"},sameColorAs:function t(e){return this.value===e.value}};r.default=n},{}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default=n;function n(){this.setup=function(){};this.render=function(){};this.renderTerritory=function(){}}},{}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=s(i);function s(t){return t&&t.__esModule?t:{default:t}}var o=function t(e,r){this.boardState=e;this.intersections=r;Object.freeze(this)};o._startingAt=function(t,e,r){var i=t.intersectionAt(e,r);var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)}),s=n(a,2),o=s[0],u=s[1];return[o,u]};o.allFor=function(t){var e=[];var r=[];t.intersections.forEach(function(i){if(e.indexOf(i)>-1){}else{var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)}),s=n(a,2),u=s[0],l=s[1];r.push(new o(t,u));e=e.concat(u)}});return r};o.merge=function(t,e){var r=[e];var n=-1;while(r.length!==n){n=r.length;r=t.filter(function(t){return t.isEmpty()&&t.isTerritory()&&t.territoryColor()===e.territoryColor()&&t.expandedBoundaryStones().some(function(t){return r.some(function(e){return e.expandedBoundaryStones().indexOf(t)>-1})})})}return r};o.prototype={isEmpty:function t(){return this.intersections[0].isEmpty()},isTerritory:function t(){var e=this.intersections[0];if(!e.isEmpty()){return false}var r=o._startingAt(this.boardState,e.y,e.x),i=n(r,2),s=i[0],u=i[1];var l=a.default.unique(u.map(function(t){return t.value}));var t=l.length===1&&l[0]!=="empty";return t},territoryColor:function t(){var e=this.intersections[0];var r=o._startingAt(this.boardState,e.y,e.x),i=n(r,2),s=i[0],u=i[1];var l=a.default.unique(u.map(function(t){return t.value}));var f=l.length===1&&l[0]!=="empty";if(!e.isEmpty()||!f){throw new Error("Attempted to obtain territory color for something that isn't territory, region containing "+e.y+","+e.x)}else{return l[0]}},isBlack:function t(){return this.territoryColor()==="black"},isWhite:function t(){return this.territoryColor()==="white"},isNeutral:function t(){return!this.intersections[0].isBlack()&&!this.intersections[0].isWhite()&&!this.isTerritory()},exterior:function t(){var e=this;return this.boardState.intersections.filter(function(t){return e.intersections.indexOf(t)<0&&e.boardState.neighborsFor(t.y,t.x).some(function(t){return e.intersections.indexOf(t)>-1})})},boundaryStones:function t(){var e=this;if(!this.isEmpty()){throw new Error("Attempted to obtain boundary stones for non-empty region")}return this.exterior().filter(function(t){return!t.sameColorAs(e.intersections[0])})},expandedBoundaryStones:function t(){var e=this.boundaryStones();var r=o.allFor(this.boardState).filter(function(t){return t.intersections.some(function(t){return e.indexOf(t)>-1})});return a.default.flatMap(r,function(t){return t.intersections})},lengthOfTerritoryBoundary:function t(){var e=this;var r=this.intersections.filter(function(t){return t.y===0||t.y===e.boardState.boardSize-1||t.x===0||t.x===e.boardState.boardSize-1});var n=this.intersections.filter(function(t){return t.y%e.boardState.boardSize-1===0&&t.x%e.boardState.boardSize-1===0});return this.boundaryStones().length+r.length+n.length},containsSquareFour:function t(){var e=this;return this.intersections.some(function(t){return[[0,0],[0,1],[1,0],[1,1]].every(function(r){var i=n(r,2),a=i[0],s=i[1];var o=e.boardState.intersectionAt(t.y+a,t.x+s);return typeof o!=="undefined"&&o.sameColorAs(t)})})},containsCurvedFour:function t(){var e=this;return this.intersections.some(function(t){return[[[0,0],[1,0],[2,0],[2,1]],[[-1,2],[0,0],[0,1],[0,2]],[[0,0],[0,1],[1,1],[2,1]],[[-1,0],[-1,1],[-1,2],[0,0]],[[-2,1],[-1,1],[0,0],[0,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,-1],[0,0],[1,-1],[2,-1]],[[-1,-2],[-1,-1],[-1,0],[0,0]]].some(function(r){return r.every(function(r){var i=n(r,2),a=i[0],s=i[1];var o=e.boardState.intersectionAt(t.y+a,t.x+s);return typeof o!=="undefined"&&o.sameColorAs(t)})})})},numberOfEyes:function t(){if(!this.intersections[0].isEmpty()){throw new Error("Unexpected calculation of number of eyes for a non-empty region containing "+this.intersections[0].y+","+this.intersections[0].x)}var e=this.lengthOfTerritoryBoundary();if(e<2){throw new Error("Unexpected boundary length of "+e+" for region including "+this.intersections[0].y+","+this.intersections[0].x)}if(e>=10){return 2}var r=void 0;switch(e){case 2:case 3:case 4:case 5:case 6:r=1;break;case 7:r=1.5;break;case 8:if(this.containsSquareFour()){r=1}else if(this.containsCurvedFour()){r=2}else{r=1.5}break;case 9:if(this.containsSquareFour()){r=1.5}else{r=2}break;default:throw new Error("unhandled boundary length "+e)}return r}};r.default=o},{"./utils":14}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=s(i);function s(t){return t&&t.__esModule?t:{default:t}}var o=function t(e,r){var n=r.hooks,i=r.options;this.INTERSECTION_GAP_SIZE=28;this.GUTTER_MARGIN=this.INTERSECTION_GAP_SIZE-3;this.BASE_MARGIN=this.INTERSECTION_GAP_SIZE-10;this.hasCoordinates=e.hasAttribute("data-include-coordinates");this.MARGIN=this.hasCoordinates?this.BASE_MARGIN+this.GUTTER_MARGIN:this.BASE_MARGIN;this.boardElement=e;this.grid=[];this.hooks=n||{};this._options=i||{};this._initialized=false;if(this._options["fuzzyStonePlacement"]){a.default.addClass(e,"tenuki-fuzzy-placement");a.default.addClass(e,"tenuki-board-textured");this.smallerStones=true}if(a.default.hasClass(e,"tenuki-board-textured")){this.texturedStones=true}};o.hoshiPositionsFor=function(t){var e=[];if(t<7){if(t>1&&t%2===1){var r={};r.top=(t-1)/2;r.left=r.top;e.push(r)}else{}}else{var n=t>11?3:2;for(var i=0;i<3;i++){for(var a=0;a<3;a++){if((t===7||t%2===0)&&(i===1||a===1)){continue}var s={};if(i===0){s.top=n}if(i===1){s.top=(t+1)/2-1}if(i===2){s.top=t-n-1}if(a===0){s.left=n}if(a===1){s.left=(t+1)/2-1}if(a===2){s.left=t-n-1}e.push(s)}}}return e};o.prototype={_setup:function t(e){var r=this;var n=this.boardElement;r.BOARD_LENGTH=2*this.MARGIN+(e.boardSize-1)*(this.INTERSECTION_GAP_SIZE+1);var i=a.default.createElement("div",{class:"tenuki-inner-container"});r.innerContainer=i;a.default.appendElement(n,i);var s=a.default.createElement("div",{class:"tenuki-zoom-container"});r.zoomContainer=s;a.default.appendElement(i,s);r.cancelZoomElement=a.default.createElement("div",{class:"cancel-zoom"});var o=a.default.createElement("div",{class:"cancel-zoom-backdrop"});a.default.addEventListener(r.cancelZoomElement,"click",function(t){t.preventDefault();r.zoomOut();return false});a.default.addEventListener(o,"click",function(t){t.preventDefault();r.zoomOut();return false});a.default.appendElement(i,r.cancelZoomElement);a.default.appendElement(i,o);var u=function t(e,r){var n=false;var i=function t(){if(n){return}n=true;window.requestAnimationFrame(function(){window.dispatchEvent(new CustomEvent(r));n=false})};window.addEventListener(e,i)};u("resize","optimizedResize");this.generateBoard(e);r.computeSizing();s.style.willChange="transform";window.addEventListener("optimizedResize",function(){r.computeSizing()});r.touchmoveChangedTouch=null;r.touchstartEventHandler=r.handleTouchStart.bind(r);r.touchmoveEventHandler=r.handleTouchMove.bind(r);r.touchendEventHandler=r.handleTouchEnd.bind(r);a.default.addEventListener(r.innerContainer,"touchstart",r.touchstartEventHandler);a.default.addEventListener(r.innerContainer,"touchend",r.touchendEventHandler);a.default.addEventListener(r.innerContainer,"touchmove",r.touchmoveEventHandler)},computeSizing:function t(){var e=this;var r=this.innerContainer;var n=this.zoomContainer;var i=this.boardElement;r.style.height="";r.style.width="";n.style.height="";n.style.width="";r.style.transform="";i.style.width="";i.style.height="";e._touchEventFired=null;r.style.width=e.BOARD_LENGTH+"px";r.style.height=e.BOARD_LENGTH+"px";n.style.width=e.BOARD_LENGTH+"px";n.style.height=e.BOARD_LENGTH+"px";var s=r.parentNode.clientWidth/r.clientWidth;var o=r.parentNode.clientHeight/r.clientHeight;var u=Math.min(s,o);if(u>0){if(u<1){a.default.addClass(i,"tenuki-scaled")}else{a.default.removeClass(i,"tenuki-scaled")}if(u<1||u>1){r.style["transform-origin"]="top left";r.style.transform="scale3d("+u+", "+u+", 1)"}}i.style.width=r.getBoundingClientRect().width+"px";i.style.height=r.getBoundingClientRect().height+"px";n.style.willChange="";window.requestAnimationFrame(function(){n.style.willChange="transform"})},addIntersectionEventListeners:function t(e,r,n){var i=this;a.default.addEventListener(e,"mouseenter",function(){var t=r;var s=n;var o=i.hooks.hoverValue(t,s);if(o){a.default.addClass(e,"hovered");a.default.addClass(e,o)}});a.default.addEventListener(e,"mouseleave",function(){if(a.default.hasClass(this,"hovered")){a.default.removeClass(e,"hovered");a.default.removeClass(e,"black");a.default.removeClass(e,"white")}i.resetTouchedPoint()});a.default.addEventListener(e,"click",function(){var t=r;var a=n;if(!i._touchEventFired||document.body.clientWidth/window.innerWidth>1||i.hooks.gameIsOver()){i.hooks.handleClick(t,a);return}if(i.touchedPoint){if(e===i.touchedPoint){i.hooks.handleClick(t,a)}else{i.showPossibleMoveAt(e,t,a)}}else{i.showPossibleMoveAt(e,t,a)}})},handleTouchStart:function t(e){var r=this;r._touchEventFired=true;if(e.touches.length>1){if(r.zoomedIn){e.preventDefault()}return}if(!r.zoomedIn){return}var n=e.changedTouches[0].clientX;var i=e.changedTouches[0].clientY;r.dragStartX=n;r.dragStartY=i;r.zoomContainer.style.transition="none";r.animationFrameRequestID=window.requestAnimationFrame(r.processDragDelta.bind(r))},handleTouchMove:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return true}e.preventDefault();r.touchmoveChangedTouch=e.changedTouches[0];r.moveInProgress=true},handleTouchEnd:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return}r.zoomContainer.style.transition="";if(!r.moveInProgress){return}r.translateY=r.lastTranslateY;r.translateX=r.lastTranslateX;r.moveInProgress=false;r.touchmoveChangedTouch=null;window.cancelAnimationFrame(r.animationFrameRequestID)},processDragDelta:function t(){var e=this;if(!e.touchmoveChangedTouch){e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e));return}var r=e.innerContainer;var n=e.touchmoveChangedTouch.clientX;var i=e.touchmoveChangedTouch.clientY;var a=n-e.dragStartX;var s=i-e.dragStartY;var o=e.translateY+s/2.5;var u=e.translateX+a/2.5;if(o>.5*r.clientHeight-e.MARGIN){o=.5*r.clientHeight-e.MARGIN}if(u>.5*r.clientWidth-e.MARGIN){u=.5*r.clientWidth-e.MARGIN}if(o<-.5*r.clientHeight+e.MARGIN){o=-.5*r.clientHeight+e.MARGIN}if(u<-.5*r.clientWidth+e.MARGIN){u=-.5*r.clientWidth+e.MARGIN}e.zoomContainer.style.transform="translate3d("+2.5*u+"px, "+2.5*o+"px, 0) scale3d(2.5, 2.5, 1)";e.lastTranslateX=u;e.lastTranslateY=o;e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e))},showPossibleMoveAt:function t(e,r,n){var i=this;var s=this.boardElement;var o=this.zoomContainer;i.zoomContainerHeight=i.zoomContainerHeight||o.clientHeight;i.zoomContainerWidth=i.zoomContainerWidth||o.clientWidth;i.touchedPoint=e;if(a.default.hasClass(s,"tenuki-scaled")){var u=r*(this.INTERSECTION_GAP_SIZE+1);var l=n*(this.INTERSECTION_GAP_SIZE+1);var f=.5*i.zoomContainerHeight-u-i.MARGIN;var c=.5*i.zoomContainerWidth-l-i.MARGIN;o.style.transform="translate3d("+2.5*c+"px, "+2.5*f+"px, 0) scale3d(2.5, 2.5, 1)";i.translateY=f;i.translateX=c;a.default.addClass(i.cancelZoomElement,"visible");i.zoomedIn=true}},resetTouchedPoint:function t(){var e=this;e.touchedPoint=null},zoomOut:function t(){var e=this;this.resetTouchedPoint();e.zoomContainer.style.transform="";e.zoomContainer.style.transition="";e.dragStartX=null;e.dragStartY=null;e.translateY=null;e.translateX=null;e.lastTranslateX=null;e.lastTranslateY=null;a.default.removeClass(e.cancelZoomElement,"visible");e.zoomedIn=false},render:function t(e){var r=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},s=i.territory,o=i.deadStones;if(!this._initialized){this._setup(e);this._initialized=true}this.resetTouchedPoint();this.renderStonesPlayed(e.intersections);var u=e.playedPoint;this.updateMarkerPoints({playedPoint:u,koPoint:e.koPoint});if(this._options["fuzzyStonePlacement"]&&u){var l=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none"];var f=["h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];var c=l.concat(f);var d=c.some(function(t){return a.default.hasClass(r.grid[u.y][u.x],t)});if(!d){var h=a.default.cartesianProduct(l,f);var v=n(h[Math.floor(Math.random()*h.length)],2),p=v[0],m=v[1];[[-1,0],[0,-1],[0,1],[1,0]].forEach(function(t){var e=n(t,2),i=e[0],s=e[1];if(r.grid[u.y+i]&&r.grid[u.y+i][u.x+s]){var o=r.grid[u.y+i][u.x+s];if(!a.default.hasClass(o,"empty")){[[-1,0,"v-shift-downdown","v-shift-up","v-shift-down"],[-1,0,"v-shift-downdown","v-shift-upup","v-shift-none"],[-1,0,"v-shift-down","v-shift-upup","v-shift-none"],[1,0,"v-shift-upup","v-shift-down","v-shift-up"],[1,0,"v-shift-upup","v-shift-downdown","v-shift-none"],[1,0,"v-shift-up","v-shift-downdown","v-shift-none"],[0,-1,"h-shift-rightright","h-shift-left","h-shift-right"],[0,-1,"h-shift-rightright","h-shift-leftleft","h-shift-none"],[0,-1,"h-shift-right","h-shift-leftleft","h-shift-none"],[0,1,"h-shift-leftleft","h-shift-right","h-shift-left"],[0,1,"h-shift-leftleft","h-shift-rightright","h-shift-none"],[0,1,"h-shift-left","h-shift-rightright","h-shift-none"]].forEach(function(t){var e=n(t,5),r=e[0],u=e[1],l=e[2],f=e[3],c=e[4];if(i===r&&s===u&&a.default.hasClass(o,l)&&(p===f||m===f)){a.default.removeClass(o,l);a.default.addClass(o,c)}})}}});a.default.addClass(this.grid[u.y][u.x],p);a.default.addClass(this.grid[u.y][u.x],m)}}if(s){this.renderTerritory(s,o)}},renderStonesPlayed:function t(e){var r=this;e.forEach(function(t){r.renderIntersection(t)})},updateMarkerPoints:function t(e){var r=e.playedPoint,n=e.koPoint;var i=this;if(n){a.default.addClass(i.grid[n.y][n.x],"ko")}if(r){a.default.addClass(i.grid[r.y][r.x],"played")}},renderIntersection:function t(e){var r=this;var n=r.grid[e.y][e.x];var i=["intersection"];if(e.isEmpty()){i.push("empty")}else{i.push("occupied");if(e.isBlack()){i.push("black")}else{i.push("white")}var s=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none","h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];s.forEach(function(t){if(a.default.hasClass(n,t)){i.push(t)}})}this.setIntersectionClasses(n,e,i)},renderTerritory:function t(e,r){var n=this;a.default.flatten(this.grid).forEach(function(t){a.default.removeClass(t,"territory-black");a.default.removeClass(t,"territory-white");a.default.removeClass(t,"dead")});r.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"dead")});e.black.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"territory-black")});e.white.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"territory-white")})}};r.default=o},{"./utils":14}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=["simple","superko"];var i=function t(e){var r=e.koRule;this.koRule=r;if(n.indexOf(this.koRule)<0){throw new Error("Unknown ko rule: "+r)}Object.freeze(this)};i.prototype={isIllegal:function t(e,r,n){var i=n.currentState();var a=n.currentPlayer();var s=i.intersectionAt(e,r);var o=!s.isEmpty()||this._wouldBeSuicide(e,r,a,i)||this._isKoViolation(e,r,a,i,n._moves);return o},_isKoViolation:function t(e,r,n,i,a){var s=false;if(this.koRule==="simple"){var o=i.koPoint;s=o&&o.y===e&&o.x===r}else{var u=i.playAt(e,r,n);var l=a;s=a.length>0&&l.some(function(t){return t.positionSameAs(u)})}return s},_wouldBeSuicide:function t(e,r,n,i){var a=i.intersectionAt(e,r);var s=a.isEmpty()&&i.neighborsFor(a.y,a.x).filter(function(t){return t.isEmpty()}).length===0;if(!s){return false}var o=i.neighborsFor(a.y,a.x).some(function(t){var e=i.inAtari(t.y,t.x);var r=t.isOccupiedWith(n);return r&&!e});if(o){return false}var u=i.neighborsFor(a.y,a.x).some(function(t){var e=i.inAtari(t.y,t.x);var r=!t.isOccupiedWith(n);return r&&e});if(u){return false}return true}};r.default=i},{}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=c(n);var a=t("./intersection");var s=c(a);var o=t("./region");var u=c(o);var l=t("./eye-point");var f=c(l);function c(t){return t&&t.__esModule?t:{default:t}}var d=function t(e){return e.currentState()._withoutIntersectionsMatching(function(t){return e._isDeadAt(t.y,t.x)})};var h=function t(e){var r=u.default.allFor(e);var n=r.filter(function(t){return t.isNeutral()});if(r.length===0||n.length===0){return e}var i={};n.forEach(function(t){var e=null;var r=null;t.intersections.forEach(function(t){e=e||t.x;e=e||t.y;var n=Math.abs(t.y-r)+Math.abs(t.x-e);var a=["black","white"][n%2];var o=new s.default(t.y,t.x,a);i[t.y]=i[t.y]||[];i[t.y][t.x]=o})});var a=e.intersections.map(function(t){if(i[t.y]&&i[t.y][t.x]){return i[t.y][t.x]}else{return t}});return e._withNewPoints(a)};var v=function t(e){var r=u.default.allFor(e).filter(function(t){return t.isTerritory()});var n=i.default.flatMap(r,function(t){return t.intersections}).filter(function(t){return new f.default(e,t).isFalse()});var a=n.filter(function(t){return e.neighborsFor(t.y,t.x).some(function(t){return e.inAtari(t.y,t.x)})});var o=e;var l=function t(){var e=o.intersections.map(function(t){if(a.indexOf(t)>-1){return new s.default(t.y,t.x,new f.default(o,t).filledColor())}else{return t}});o=o._withNewPoints(e);var r=h(o);var n=u.default.allFor(r).filter(function(t){return t.isTerritory()});var l=i.default.flatMap(n,function(t){return t.intersections}).filter(function(t){return new f.default(r,t).isFalse()});a=l.filter(function(t){return o.neighborsFor(t.y,t.x).some(function(t){return o.inAtari(t.y,t.x)})})};while(a.length>0){l()}return o};var p=Object.freeze({score:function t(e){var r=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isBlack()});var n=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isWhite()});var i=e.territory();var a=e.currentState();return{black:i.black.length+a.whiteStonesCaptured+n.length,white:i.white.length+a.blackStonesCaptured+r.length}},territory:function t(e){var r=d(e);var n=h(r);var a=v(n);var s=u.default.allFor(a).filter(function(t){return t.isTerritory()});var o=s.filter(function(t){var e=u.default.merge(s,t);var r=e.map(function(t){return Math.ceil(t.numberOfEyes())});return r.length>0&&r.reduce(function(t,e){return t+e})>=2});var l=o.filter(function(t){return t.isBlack()});var f=o.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(l,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(f,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var m=Object.freeze({score:function t(e){var r=e.intersections().filter(function(t){return t.isBlack()&&!e._isDeadAt(t.y,t.x)});var n=e.intersections().filter(function(t){return t.isWhite()&&!e._isDeadAt(t.y,t.x)});var i=e.territory();return{black:i.black.length+r.length,white:i.white.length+n.length}},territory:function t(e){var r=u.default.allFor(d(e));var n=r.filter(function(t){return t.isTerritory()});var a=n.filter(function(t){return t.isBlack()});var s=n.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(a,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(s,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var y=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.scoreBy,n=e.komi;this._strategy={area:m,territory:p,equivalence:m}[r];this._komi=n;if(!this._strategy){throw new Error("Unknown scoring type: "+r)}if(this._komi===null||typeof this._komi==="undefined"){throw new Error("Error initializing scorer without a komi value")}if(typeof this._komi!=="number"){throw new Error("Komi value given is not a number: "+n)}this._usePassStones=r==="equivalence";Object.freeze(this)};y.prototype={score:function t(e){var r=this._strategy.score(e);r.white+=this._komi;if(this._usePassStones){return{black:r.black+e.currentState().whitePassStones,white:r.white+e.currentState().blackPassStones}}else{return r}},territory:function t(e){return this._strategy.territory(e)},usingPassStones:function t(){return this._usePassStones}};r.default=y},{"./eye-point":5,"./intersection":7,"./region":9,"./utils":14}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=o(n);var a=t("./renderer");var s=o(a);function o(t){return t&&t.__esModule?t:{default:t}}var u=function t(e,r){var n=r.hooks,a=r.options;s.default.call(this,e,{hooks:n,options:a});i.default.addClass(e,"tenuki-svg-renderer")};u.prototype=Object.create(s.default.prototype);u.prototype.constructor=u;u.prototype.generateBoard=function(t){var e=this;var r=this;var n=r.zoomContainer;var a=i.default.createSVGElement("svg");r.svgElement=a;var o=i.default.createSVGElement("defs");i.default.appendElement(a,o);r.blackGradientID=i.default.randomID("black-gradient");r.whiteGradientID=i.default.randomID("white-gradient");var u=i.default.createSVGElement("radialGradient",{attributes:{id:r.blackGradientID,cy:"0",r:"55%"}});i.default.appendElement(u,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"#848484"}}));i.default.appendElement(u,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"hsl(0, 0%, 20%)"}}));i.default.appendElement(o,u);var l=i.default.createSVGElement("radialGradient",{attributes:{id:r.whiteGradientID,cy:"0",r:"70%"}});i.default.appendElement(l,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"white"}}));i.default.appendElement(l,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#DDDDDD"}}));i.default.appendElement(o,l);var f=i.default.createSVGElement("g",{attributes:{class:"contents",transform:"translate("+this.MARGIN+", "+this.MARGIN+")"}});var c=i.default.createSVGElement("g",{attributes:{class:"lines"}});i.default.appendElement(f,c);for(var d=0;d<t.boardSize-1;d++){for(var h=0;h<t.boardSize-1;h++){var v=i.default.createSVGElement("rect",{attributes:{y:d*(this.INTERSECTION_GAP_SIZE+1)-.5,x:h*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,class:"line-box"}});i.default.appendElement(c,v)}}var p=i.default.createSVGElement("g",{attributes:{class:"hoshi"}});i.default.appendElement(f,p);s.default.hoshiPositionsFor(t.boardSize).forEach(function(t){var r=i.default.createSVGElement("circle",{attributes:{class:"hoshi",cy:t.top*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:t.left*(e.INTERSECTION_GAP_SIZE+1)-.5,r:2}});i.default.appendElement(p,r)});var m=i.default.createSVGElement("g",{attributes:{class:"intersections"}});i.default.appendElement(f,m);if(this.hasCoordinates){(function(){var r=i.default.createSVGElement("g",{attributes:{class:"coordinates",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}});var n=function n(s){if(e.hasCoordinates){[16/2+1-(16+16/2+16/(2*2)+16/(2*2*2)),16/2+1+(16+16/2)+(t.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(n){i.default.appendElement(r,i.default.createSVGElement("text",{text:t.xCoordinateFor(s),attributes:{"text-anchor":"middle",y:n-.5,x:s*(e.INTERSECTION_GAP_SIZE+1)-.5}}))});[-1*(16+16/2+16/(2*2)),16+16/2+16/(2*2)+(t.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(n){i.default.appendElement(r,i.default.createSVGElement("text",{text:t.yCoordinateFor(s),attributes:{"text-anchor":"middle",y:s*(e.INTERSECTION_GAP_SIZE+1)-.5+16/(2*2),x:n-.5}}))});i.default.appendElement(a,r)}};for(var s=0;s<t.boardSize;s++){n(s)}})()}for(var y=0;y<t.boardSize;y++){for(var E=0;E<t.boardSize;E++){var b=i.default.createSVGElement("g",{attributes:{class:"intersection"}});i.default.appendElement(m,b);var S=i.default.createSVGElement("g",{attributes:{class:"intersection-inner-container"}});i.default.appendElement(b,S);var g=i.default.createSVGElement("rect",{attributes:{y:y*(this.INTERSECTION_GAP_SIZE+1)-this.INTERSECTION_GAP_SIZE/2-.5,x:E*(this.INTERSECTION_GAP_SIZE+1)-this.INTERSECTION_GAP_SIZE/2-.5,width:this.INTERSECTION_GAP_SIZE,height:this.INTERSECTION_GAP_SIZE}});i.default.appendElement(S,g);var _=this.INTERSECTION_GAP_SIZE/2;if(this.smallerStones){_-=1}var w={class:"stone",cy:y*(this.INTERSECTION_GAP_SIZE+1)-.5,cx:E*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,r:_};if(this.texturedStones){i.default.appendElement(S,i.default.createSVGElement("circle",{attributes:{class:"stone-shadow",cy:w["cy"]+2,cx:w["cx"],width:w["width"],height:w["height"],r:_}}))}var I=i.default.createSVGElement("circle",{attributes:w});i.default.appendElement(S,I);i.default.appendElement(S,i.default.createSVGElement("circle",{attributes:{class:"marker",cy:y*(this.INTERSECTION_GAP_SIZE+1)-.5,cx:E*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,r:4.5}}));i.default.appendElement(S,i.default.createSVGElement("rect",{attributes:{class:"ko-marker",y:y*(this.INTERSECTION_GAP_SIZE+1)-6-.5,x:E*(this.INTERSECTION_GAP_SIZE+1)-6-.5,width:12,height:12}}));i.default.appendElement(S,i.default.createSVGElement("rect",{attributes:{class:"territory-marker",y:y*(this.INTERSECTION_GAP_SIZE+1)-6,x:E*(this.INTERSECTION_GAP_SIZE+1)-6,width:11,height:11}}));this.grid[y]=this.grid[y]||[];this.grid[y][E]=b;this.addIntersectionEventListeners(b,y,E)}}i.default.appendElement(a,f);i.default.appendElement(n,a);r.svgElement.setAttribute("height",r.BOARD_LENGTH);r.svgElement.setAttribute("width",r.BOARD_LENGTH)};u.prototype.computeSizing=function(){var t=this;s.default.prototype.computeSizing.call(this);this.svgElement.style.transform="none";window.requestAnimationFrame(function(){t.svgElement.style.transform=""})};u.prototype.setIntersectionClasses=function(t,e,r){if(t.getAttribute("class")!==r.join(" ")){t.setAttribute("class",r.join(" "))}if(this.texturedStones){if(e.isEmpty()){t.querySelector(".stone").setAttribute("style","")}else{t.querySelector(".stone").setAttribute("style","fill: url("+window.location+"#"+this[e.value+"GradientID"]+")")}}};r.default=u},{"./renderer":10,"./utils":14}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default={flatten:function t(e){return e.reduce(function(t,e){return t.concat(e)})},flatMap:function t(e,r){return Array.prototype.concat.apply([],e.map(r))},cartesianProduct:function t(e,r){return this.flatten(e.map(function(t){return r.map(function(e){return[t,e]})}))},randomID:function t(e){var r=[0,1,2,3].map(function(){return Math.floor(Math.random()*65536).toString(16).substring(1)}).join("");return e+"-"+r},createElement:function t(e,r){var n=document.createElement(e);if(typeof r!=="undefined"){if(r.class){n.className=r.class}}return n},createSVGElement:function t(e,r){var n=this;var i="http://www.w3.org/2000/svg";var a=document.createElementNS(i,e);if(typeof r!=="undefined"){if(r.class){r.class.split(" ").forEach(function(t){n.addClass(a,t)})}if(r.attributes){Object.keys(r.attributes).forEach(function(t){a.setAttribute(t,r.attributes[t])})}if(r.text){a.textContent=r.text.toString()}}return a},appendElement:function t(e,r){e.insertBefore(r,null)},addEventListener:function t(e,r,n){e.addEventListener(r,n,false)},removeClass:function t(e,r){if(e.classList&&e.classList.remove){e.classList.remove(r);return}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class").replace(n,""))}else{e.className=e.getAttribute("class").replace(n,"")}},addClass:function t(e,r){if(e.classList&&e.classList.add){e.classList.add(r);return}if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class")+" "+r)}else{e.className=e.getAttribute("class")+" "+r}},hasClass:function t(e,r){if(e.classList&&e.classList.contains){return e.classList.contains(r)}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){return n.test(e.getAttribute("class"))}else{return n.test(e.className)}},toggleClass:function t(e,r){if(e.classList&&e.classList.toggle){e.classList.toggle(r);return}if(this.hasClass(e,r)){this.removeClass(e,r)}else{this.addClass(e,r)}},unique:function t(e){var t=[];e.forEach(function(e){if(t.indexOf(e)<0){t.push(e)}});return t}}},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n={};function i(t,e,r,i){n[t]=n[t]||{};n[t][e]=n[t][e]||{};n[t][e][r]=n[t][e][r]||{};if(n[t][e][r][i]){return n[t][e][r][i]}var a=Math.floor(Math.random()*(Math.pow(2,31)-1));n[t][e][r][i]=a;return a}r.default={hash:function t(e,r){var n=0;r.forEach(function(t){if(!t.isEmpty()){var r=i(e,t.y,t.x,t.value);n=n^r}});return n}}},{}]},{},[1])(1)});
